# Public MCP Server
services:
  mcp-knowledge-graph:
    build: .
    container_name: mcp-kg-public
    restart: unless-stopped
    ports:
      - "${MCP_PUBLIC_PORT:-8781}:8780"
    env_file:
      - /data/.env
    environment:
      - NEO4J_URI=${NEO4J_URI:-bolt://100.89.157.49:7687}
      - NEO4J_USER=${NEO4J_USER:-neo4j}
      - MIN_TRUST_SCORE=${MIN_TRUST_SCORE:-0.7}
    healthcheck:
      test: ["CMD", "curl", "-f", "http://localhost:8780/health"]
      interval: 30s
      timeout: 10s
      retries: 3

# Example with Neo4j (optional)
# Uncomment to run with a local Neo4j instance
#
#   neo4j:
#     image: neo4j:5-community
#     container_name: mcp-kg-neo4j
#     environment:
#       - NEO4J_AUTH=neo4j/${NEO4J_PASSWORD:-change_this}
#     ports:
#       - "7474:7474"
#       - "7687:7687"
#     volumes:
#       - neo4j-data:/data
#
# volumes:
#   neo4j-data:
