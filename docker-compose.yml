# 공개 MCP 서버 (내부 API 없음)
services:
  mcp-knowledge-graph-public:
    build: .
    container_name: mcp-kg-public
    restart: unless-stopped
    ports:
      - "${MCP_PUBLIC_PORT:-8781}:8780"
    environment:
      - NEO4J_URI=${NEO4J_URI:-bolt://moche-neo4j:7687}
      - NEO4J_USER=${NEO4J_USER:-neo4j}
      - NEO4J_PASSWORD=${NEO4J_PASSWORD}
      - MIN_TRUST_SCORE=${MIN_TRUST_SCORE:-0.7}
    networks:
      - moche-network
    healthcheck:
      test: ["CMD", "curl", "-f", "http://localhost:8780/health"]
      interval: 30s
      timeout: 10s
      retries: 3

networks:
  moche-network:
    external: true
    name: moche-network
